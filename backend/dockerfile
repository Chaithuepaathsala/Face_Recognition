# ğŸ Use official Python slim image
FROM python:3.10-slim

# ğŸ› ï¸ Install system dependencies for dlib
RUN apt-get update && \
    apt-get install -y \
        build-essential \
        cmake \
        libboost-all-dev \
        python3-dev \
    && rm -rf /var/lib/apt/lists/*

# ğŸ“ Set working directory
WORKDIR /app

# ğŸ“ Copy requirements first (to leverage Docker cache)
COPY requirements.txt .

# ğŸ§° Upgrade pip
RUN pip install --upgrade pip

# ğŸ§  Install dlib first (avoids build errors)
RUN pip install dlib==19.22.1

# ğŸ“¦ Install the rest of your dependencies
RUN pip install -r requirements.txt

# ğŸ“‚ Copy the rest of your code
COPY . .

# ğŸš€ Define the default command to run your app
# Adjust "app.py" if your entry point file has a different name
CMD ["python", "app.py"]